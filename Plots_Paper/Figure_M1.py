import numpy as np
import matplotlib.pyplot as plt
import matplotlib.gridspec as gridspec
import matplotlib
from pylab import *
from matplotlib import colors
import matplotlib.patches as patches
import seaborn as sns
import pickle
import time
import copy
import operator



#1. Definir colores
#:::::::::::::::::::::::::::::::::::::::::::::::::::::::
cmaptest=matplotlib.cm.get_cmap("BrBG") #Selecciona el heatmap que quieres trocear                           
color1=cmaptest(0.95);color2=cmaptest(0.05)
#:::::::::::::::::::::::::::::::::::::::::::::::::::::::

#1. CHOOSE DATASET TO PLOT HISTOGRAM
#++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
#++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
Datasets=['ToyDataset','Large_Categories','Large_Quartiles']
Dataset=Datasets[1]

if Dataset=='ToyDataset':

#Data
#================================================================
    AccuraciesBestLikelihood=[ 0.602038103677, 0.643287549845, 0.656357997342, 0.663103677448, 0.7085733274,\
                           0.7175343376, 0.7353788214, 0.7461896323, 0.752027027, 0.762040319, 0.7659282233,\
                           0.7692179885, 0.7672241914, 0.7706136464, 0.7722308374, 0.7713003988, 0.7733606557,\
                           0.774778467, 0.7740363314, 0.7737151086]

    AccuraciesAverage=[0.6005250332, 0.6387704918, 0.6545547187, 0.6623416039, 0.7056313691, 0.7154452813,\
                   0.7323681879, 0.7471045636, 0.7521178556, 0.7618808152, 0.7665019938, 0.7693464776,\
                   0.7670491803, 0.7699955693, 0.7724634471, 0.7710323438, 0.7731280461, 0.7744926894,\
                   0.7737128932, 0.7744971201]


    Error=[0.0015607924, 0.0020436837, 0.0015536217, 0.0002998767, 0.001030894, 0.0005699106, 0.000890334,\
       0.0005730987, 0.0003873567, 0.0003058961, 0.0002931946, 0.0002100654, 0.0003469556, 0.0002867419,\
       0.0001917573, 0.0002833848, 0.0004927802, 0.0002984618, 0.0002311121, 0.0004160104]
#================================================================

    #Parameters for plot
    #================================================================
    ymin=0.58
    ymax=0.80
    yticks_Labels=[0.58, 0.6, 0.62, 0.64, 0.66, 0.68, 0.70, 0.72, 0.74, 0.76, 0.78, 0.8]
    
    xticks_Labels=['K=3,L=5','K=5,L=5','K=5,L=10','K=10,L=5','K=10,L=10','K=10,L=20',\
            'K=20,L=10','K=20, L=20','K=20, L=40','K=40, L=20','K=40, L=40',\
            'K=40, L=50','K=50, L=40','K=50, L=50','K=60, L=50','K=50, L=60',\
            'K=60, L=60','K=70, L=60','K=60, L=70','K=70, L=70' ]
    #================================================================
    

elif Dataset=='Large_Categories':

    #Data
    #===============================================================
    AccuraciesBestLikelihood=[0.8284457877, 0.833074661, 0.8346403093, 0.8285547024, 0.8339868213,\
                                  0.8396503839, 0.832829603, 0.8389015956,0.8394189403]#, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
        
    AccuraciesAverage=[ 0.8281843925, 0.8306948756, 0.8341828677, 0.8280700321, 0.8329711921,\
                            0.8371943582, 0.8330038665, 0.8367641453,0.8381609759]#, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]

    Error=[0.0001039871, 0.0009443226, 0.0003082256, 0.0003414349, 0.0003444076, 0.0010010248, 0.0001617415,\
               0.0009491153, 0.0008034602]#, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
    #===============================================================

    #Parameters for plot
    #================================================================

    ymin=0.775
    ymax=0.845
    yticks_Labels=[0.78, 0.80, 0.82, 0.84]

    xticks_Labels=\
    ['K=3,L=5','K=5,L=5', 'K=5,L=10', 'K=10,L=5', 'K=10,L=10', 'K=10,L=20', 'K=20,L=10', 'K=20, L=20',\
     'K=20, L=30', 'K=30, L=20', 'K=30, L=30', 'K=30, L=40', 'K=40, L=30', 'K=40, L=40', 'K=40, L=50',\
     'K=50, L=40', 'K=50, L=50']
    #================================================================

elif Dataset=='Large_Quartiles':
    #Data
    #==========================================================================================================
    
    AccuraciesAverage=[0.8195283995
                       ,0.8196509285
                       ,0.8222485433
                       ,0.8185154931
                       ,0.8221287371
                       ,0.8230218374
                       ,0.821355443
                       ,0.8230517889
                       ]#, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]

    Error=[0.0001051922
           ,0.0002191443
           ,0.0002292874
           ,0.0002249292
           ,0.0002374911
           ,0.0005673862
           ,0.0003156764
           ,0.0006316141
           ]#, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]

    #==========================================================================================================

    #Parameters for plot
    #================================================================
    ymin=0.775
    ymax=0.845
    yticks_Labels=[0.78, 0.80, 0.82, 0.84]

    xticks_Labels=['K=3,L=5','K=5,L=5', 'K=5,L=10', 'K=10,L=5', 'K=10,L=10', 'K=10,L=15', 'K=15,L=10', 'K=15, L=15',\
                   'K=15, L=20', 'K=20, L=15', 'K=20, L=20', 'K=20, L=25', 'K=25, L=20', 'K=25, L=25', 'K=25, L=30', 'K=30, L=25','K=30, L=30' ]
    #================================================================
    
#Xticks positions
#======================================
xticks_Position=[]
contador=0
for i in range(len(AccuraciesAverage)):
    xticks_Position.append(contador)
    contador+=0.75
#======================================

#+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
#+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++



#2. PLOTS
#+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
#+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

#2.1. Plotting Parameters
#==============================================
#2.1.1.Ejes: limites y nombres
#:::::::::::::::::::::::
size_eje=15
size_ticks=10
#:::::::::::::::::::::::

#2.1.2.Xticks positions
#:::::::::::::::::::::::
xticks_Position=[];contador=0
for i in range(len(AccuraciesAverage)):
    xticks_Position.append(contador)
    contador+=0.75
#:::::::::::::::::::::::
#==============================================

#fig=plt.figure(figsize=(12,10))
#sns.set_style("dark")


plt.errorbar(xticks_Position,AccuraciesAverage,yerr=Error, marker='o',markersize=4, ls='solid')
plt.hlines(0.7876418947, -0.5, 100, colors='k', linestyles='solid')

plt.gcf().subplots_adjust(bottom=0.22)
ylabel('Accuracy',fontsize=size_eje)
xlabel('Number of Groups',fontsize=size_eje)

#xticks and yticks
#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
xTickMarks = xticks_Labels
xticks([pos for pos in xticks_Position], xTickMarks,rotation=40, fontsize=size_ticks)#Fija la posicion de los xticks

yTicksMarks=yticks_Labels
yticks(yTicksMarks,fontsize=size_ticks)

xlim( xticks_Position[0]-0.1, xticks_Position[-1]+0.5 )
ylim( ymin,ymax )
#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
#sns.despine()

plt.savefig('../../Plots_Paper/Figure_M1.pdf')

plt.show()

#++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
#++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

